<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/styles/style.css">
</head>

<body>
    <script>
        function logout() {
        fetch('/logout', {method: 'POST'}).then(() => {
          window.location.reload()    
        })
    
    } </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <nav style="margin:0px;">
        <div class="navbar_top_half">
            <a class="active" href="#" style="font-family: Consolas;"><i class="fa fa-fw fa-home"></i> Username</a>
            <a href="#" style="color: white;"> / </a>
            <a href="#" style="font-family: Consolas;">Searchbox  <i class="fa fa-fw fa-search"></i></a>
            <div class="dropdown">
                <img class = "tools" src="/img/icons/settings2.png">
                <div class="dropdown-content" >
                  <img class = "user_image" src = "/images/person.jpg" alt = "">
                  <div style="font-size:smaller"> Name Surname</div>
                  <button onclick="" class="dropbtn">Edit email </button>
                  <button onclick="" class="dropbtn">Change city </button>
                  <button onclick="logout()" class="dropbtn_log"><img src="/img/icons/logout.png" > Log out</button>
                </div>
              </div>
        </div>
        <div class="navbar_bottom_half">
            <a class="active" href="/"><img class="bar_icon" src="/img/icons/idea.png" alt=""> Ideas</a>
            <a href="/mapview"><img class="bar_icon" src="/img/icons/street-map.png" alt=""> City</a>
            <a href="/prview"><img class="bar_icon" src="/img/icons/minimize.png" alt=""> Pull Requests</a>
            <a href="#"><img class="bar_icon" src="/img/icons/photo.png" alt=""> Images</a>
            <a href="#"><img class="bar_icon" src="/img/icons/open-book.png" alt=""> Wiki</a>
            <a href="#"><img class="bar_icon" src="/img/icons/email.png" alt=""> Insights</a>
        </div>
    </nav>

    <div class="google-map" style="width: 100vw; height: calc(100vh - 90px); margin-top: 0px; padding: 0px;">

    </div>

    <script>
        let geocoder = null;
        let googleMap = document.querySelector('.google-map');
        let map = null;
        let marker = null;
        let loadedLocations = {};
        let address = 'Łódź';

        function initMap() {
            geocoder = new google.maps.Geocoder();
            map = new google.maps.Map(googleMap, {
                zoom: 13
            });
            marker = new google.maps.Marker({
                map: map
            });
            google.maps.event.addListenerOnce(map, 'idle', codeAddress);
        }

        function codeAddress() {
            if (!loadedLocations[address]) {
                geocoder.geocode({
                    address: address
                }, function(results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        map.setCenter(results[0].geometry.location);
                        loadedLocations[address] = results[0].geometry.location;
                        marker.setPosition(loadedLocations[address]);
                    } else {
                        console.log("Nie udało się załadować miejsca na mapie, " + status);
                    }
                });
            } else {
                map.setCenter(loadedLocations[address]);
                marker.setPosition(loadedLocations[address]);
            }
        }
        // AIzaSyDa4nN-bDVonpOyK5S7HAx23krp3ZBRLhE

        // AIzaSyCJwbd6w9_JOQ3SR-rKC0N5oEb2DY4GIJY
    </script>
    <script src='https://maps.googleapis.com/maps/api/js?key=AIzaSyDa4nN-bDVonpOyK5S7HAx23krp3ZBRLhE&callback=initMap' async defer></script>

</body>

</html>